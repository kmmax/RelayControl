<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<!--    <meta http-equiv="refresh" content="1">-->
    <title>Title</title>
    <link rel="stylesheet" type="text/css" href="./styles/styles.css">
    <script>
      function relayState(device, lamp, state=undefined) {
        var address = "192.168.1.203";

        const url_set = `http://${address}/${device}?params=${state}`;
        const url_get = `http://${address}/${device}`;
        
        let url = url_get;
        if (1 == state || 0 == state) {
            url = url_set;
        }
        console.log(url);

        fetch(url, {
            mode: 'cors' 
        })
        .then((response) => {
            return response.json();
        })
        .then((data) => {
            console.log(data);
            let authors = data;

            console.log(`State: ${authors.return_value}`)
            console.log(lamp);
            if (1 == authors.return_value) {
                document.getElementById(lamp).textContent = "ON";
            }
            else {
                document.getElementById(lamp).textContent = "OFF";
            }
        })
        .catch(function(error) {
            console.log("--- error ---");
            console.log(error);
        });
      }
  </script>
</head>

<body>
<form>
<h2>Relays control</h2>
<table style="border-collapse: collapse; width: 100%;" border="1">
    <tbody>
    <tr>
        <td style="width: 11.4686%;" class="header"><strong>№</strong></td>
        <td style="width: 38.5314%;" class="header"><strong>Name</strong></td>
        <td style="width: 25%;" class="header"><strong>State</strong></td>
        <td style="width: 25%;" class="header"><strong>Control</strong></td>
    </tr>
    <tr>
        <td style="width: 11.4686%; text-align: center;">1</td>
        <td style="width: 38.5314%; text-align: center;">Relay №1</td>
        <td id="lamp1" style="width: 25%; text-align: center;">ON</td>
        <td style="width: 25%; text-align: center;">
            <button type="button" id="r1_on" class="button_1674200952262" onClick="relayState('relay1', 'lamp1', 1)">ON</button>
            <button type="button" id="r1_off" class="buttonOff" onClick="relayState('relay1', 'lamp1', 0)">OFF</button>
        </td>
    </tr>
    <tr>
        <td style="width: 11.4686%; text-align: center;">2</td>
        <td style="width: 38.5314%; text-align: center;">Relay №2 </td>
        <td id="lamp2" style="width: 25%; text-align: center;"></td>
        <td style="width: 25%; text-align: center;">
            <button type="button" id="r2_on" class="button_1674200952262" onClick="relayState('relay2', 'lamp2', 1)">ON</button>
            <button type="button" id="r2_off" class="buttonOff" onClick="relayState('relay2', 'lamp2', 0)">OFF</button>
        </td>
    </tr>
    <tr>
        <td style="width: 11.4686%; text-align: center;">3</td>
        <td style="width: 38.5314%; text-align: center;">Relay №3</td>
        <td id="lamp3" style="width: 25%; text-align: center;"></td>
        <td style="width: 25%; text-align: center;">
            <button type="button" id="r3_on" class="button_1674200952262" onClick="relayState('relay3', 'lamp3', 1)">ON</button>
            <button type="button" id="r3_off" class="buttonOff" onClick="relayState('relay3', 'lamp3', 0)">OFF</button>
        </td>
    </tr>
    <tr>
        <td style="width: 11.4686%; text-align: center;">4</td>
        <td style="width: 38.5314%; text-align: center;">Relay №4</td>
        <td id="lamp4" style="width: 25%; text-align: center;"></td>
        <td style="width: 25%; text-align: center;">
            <button type="button" id="r4_on" class="button_1674200952262" onClick="relayState('relay4', 'lamp4', 1)">ON</button>
            <button type="button" id="r4_off" class="buttonOff" onClick="relayState('relay4', 'lamp4', 0)">OFF</button>
        </td>
    </tr>
    </tbody>
</table>
</form>
<script>
    relayState('relay1', 'lamp1');
    relayState('relay2', 'lamp2');
    relayState('relay3', 'lamp3');
    relayState('relay4', 'lamp4');
</script>
</body>

</html>